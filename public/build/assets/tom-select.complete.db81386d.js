function U(r,e){r.split(/\s+/).forEach(t=>{e(t)})}class ye{constructor(){this._events={}}on(e,t){U(e,i=>{this._events[i]=this._events[i]||[],this._events[i].push(t)})}off(e,t){var i=arguments.length;if(i===0){this._events={};return}U(e,s=>{if(i===1)return delete this._events[s];s in this._events&&this._events[s].splice(this._events[s].indexOf(t),1)})}trigger(e,...t){var i=this;U(e,s=>{if(s in i._events)for(let o of i._events[s])o.apply(i,t)})}}function Oe(r){return r.plugins={},class extends r{constructor(...e){super(...e),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(e,t){r.plugins[e]={name:e,fn:t}}initializePlugins(e){var t,i;const s=this,o=[];if(Array.isArray(e))e.forEach(n=>{typeof n=="string"?o.push(n):(s.plugins.settings[n.name]=n.options,o.push(n.name))});else if(e)for(t in e)e.hasOwnProperty(t)&&(s.plugins.settings[t]=e[t],o.push(t));for(;i=o.shift();)s.require(i)}loadPlugin(e){var t=this,i=t.plugins,s=r.plugins[e];if(!r.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');i.requested[e]=!0,i.loaded[e]=s.fn.apply(t,[t.plugins.settings[e]||{}]),i.names.push(e)}require(e){var t=this,i=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(i.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return i.loaded[e]}}}var ue;const de="[\u0300-\u036F\xB7\u02BE]",we=new RegExp(de,"g");var R;const pe={\u00E6:"ae","\u2C65":"a",\u00F8:"o"},be=new RegExp(Object.keys(pe).join("|"),"g"),Ce=[[67,67],[160,160],[192,438],[452,652],[961,961],[1019,1019],[1083,1083],[1281,1289],[1984,1984],[5095,5095],[7429,7441],[7545,7549],[7680,7935],[8580,8580],[9398,9449],[11360,11391],[42792,42793],[42802,42851],[42873,42897],[42912,42922],[64256,64260],[65313,65338],[65345,65370]],B=r=>r.normalize("NFKD").replace(we,"").toLowerCase().replace(be,function(e){return pe[e]}),K=(r,e="|")=>r.length>1?"(?:"+r.join(e)+")":r[0],fe=r=>{if(r.length===1)return[[r]];var e=[];return fe(r.substring(1)).forEach(function(t){var i=t.slice(0);i[0]=r.charAt(0)+i[0],e.push(i),i=t.slice(0),i.unshift(r.charAt(0)),e.push(i)}),e},Ie=()=>{var r={};Ce.forEach(i=>{for(let s=i[0];s<=i[1];s++){let o=String.fromCharCode(s),n=B(o);n!=o.toLowerCase()&&(n in r||(r[n]=[n]),r[n].push(o))}});var e=Object.keys(r);e=e.sort((i,s)=>s.length-i.length),ue=new RegExp("("+K(e)+de+"*)","g");var t={};return e.sort((i,s)=>i.length-s.length).forEach(i=>{var s=fe(i),o=s.map(n=>(n=n.map(l=>r.hasOwnProperty(l)?K(r[l]):l),K(n,"")));t[i]=K(o)}),t},Se=r=>(R===void 0&&(R=Ie()),r.normalize("NFKD").toLowerCase().split(ue).map(t=>{if(t=="")return"";const i=B(t);if(R.hasOwnProperty(i))return R[i];const s=t.normalize("NFC");return s!=t?K([t,s]):t}).join("")),xe=(r,e)=>{if(!!r)return r[e]},Ae=(r,e)=>{if(!!r){for(var t,i=e.split(".");(t=i.shift())&&(r=r[t]););return r}},Q=(r,e,t)=>{var i,s;return!r||(r=r+"",s=r.search(e.regex),s===-1)?0:(i=e.string.length/r.length,s===0&&(i+=.5),i*t)},J=r=>(r+"").replace(/([\$\(-\+\.\?\[-\^\{-\}])/g,"\\$1"),Y=(r,e)=>{var t=r[e];t&&!Array.isArray(t)&&(r[e]=[t])},q=(r,e)=>{if(Array.isArray(r))r.forEach(e);else for(var t in r)r.hasOwnProperty(t)&&e(r[t],t)},ie=(r,e)=>typeof r=="number"&&typeof e=="number"?r>e?1:r<e?-1:0:(r=B(r+"").toLowerCase(),e=B(e+"").toLowerCase(),r>e?1:e>r?-1:0);class ke{constructor(e,t){this.items=e,this.settings=t||{diacritics:!0}}tokenize(e,t,i){if(!e||!e.length)return[];const s=[],o=e.split(/\s+/);var n;return i&&(n=new RegExp("^("+Object.keys(i).map(J).join("|")+"):(.*)$")),o.forEach(l=>{let a,c=null,u=null;n&&(a=l.match(n))&&(c=a[1],l=a[2]),l.length>0&&(u=J(l),this.settings.diacritics&&(u=Se(u)),t&&(u="\\b"+u)),s.push({string:l,regex:u?new RegExp(u,"iu"):null,field:c})}),s}getScoreFunction(e,t){var i=this.prepareSearch(e,t);return this._getScoreFunction(i)}_getScoreFunction(e){const t=e.tokens,i=t.length;if(!i)return function(){return 0};const s=e.options.fields,o=e.weights,n=s.length,l=e.getAttrFn;if(!n)return function(){return 1};const a=function(){return n===1?function(c,u){const h=s[0].field;return Q(l(u,h),c,o[h])}:function(c,u){var h=0;if(c.field){const m=l(u,c.field);!c.regex&&m?h+=1/n:h+=Q(m,c,1)}else q(o,(m,C)=>{h+=Q(l(u,C),c,m)});return h/n}}();return i===1?function(c){return a(t[0],c)}:e.options.conjunction==="and"?function(c){for(var u=0,h,m=0;u<i;u++){if(h=a(t[u],c),h<=0)return 0;m+=h}return m/i}:function(c){var u=0;return q(t,h=>{u+=a(h,c)}),u/i}}getSortFunction(e,t){var i=this.prepareSearch(e,t);return this._getSortFunction(i)}_getSortFunction(e){var t,i,s;const o=this,n=e.options,l=!e.query&&n.sort_empty?n.sort_empty:n.sort,a=[],c=[],u=function(C,I){return C==="$score"?I.score:e.getAttrFn(o.items[I.id],C)};if(l)for(t=0,i=l.length;t<i;t++)(e.query||l[t].field!=="$score")&&a.push(l[t]);if(e.query){for(s=!0,t=0,i=a.length;t<i;t++)if(a[t].field==="$score"){s=!1;break}s&&a.unshift({field:"$score",direction:"desc"})}else for(t=0,i=a.length;t<i;t++)if(a[t].field==="$score"){a.splice(t,1);break}for(t=0,i=a.length;t<i;t++)c.push(a[t].direction==="desc"?-1:1);const h=a.length;if(h)if(h===1){const m=a[0].field,C=c[0];return function(I,d){return C*ie(u(m,I),u(m,d))}}else return function(m,C){var I,d,v;for(I=0;I<h;I++)if(v=a[I].field,d=c[I]*ie(u(v,m),u(v,C)),d)return d;return 0};else return null}prepareSearch(e,t){const i={};var s=Object.assign({},t);if(Y(s,"sort"),Y(s,"sort_empty"),s.fields){Y(s,"fields");const o=[];s.fields.forEach(n=>{typeof n=="string"&&(n={field:n,weight:1}),o.push(n),i[n.field]="weight"in n?n.weight:1}),s.fields=o}return{options:s,query:e.toLowerCase().trim(),tokens:this.tokenize(e,s.respect_word_boundaries,i),total:0,items:[],weights:i,getAttrFn:s.nesting?Ae:xe}}search(e,t){var i=this,s,o;o=this.prepareSearch(e,t),t=o.options,e=o.query;const n=t.score||i._getScoreFunction(o);e.length?q(i.items,(a,c)=>{s=n(a),(t.filter===!1||s>0)&&o.items.push({score:s,id:c})}):q(i.items,(a,c)=>{o.items.push({score:1,id:c})});const l=i._getSortFunction(o);return l&&o.items.sort(l),o.total=o.items.length,typeof t.limit=="number"&&(o.items=o.items.slice(0,t.limit)),o}}const k=r=>{if(r.jquery)return r[0];if(r instanceof HTMLElement)return r;if(r.indexOf("<")>-1){let e=document.createElement("div");return e.innerHTML=r.trim(),e.firstChild}return document.querySelector(r)},Fe=r=>r.replace(/['"\\]/g,"\\$&"),G=(r,e)=>{var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!1),r.dispatchEvent(t)},z=(r,e)=>{Object.assign(r.style,e)},A=(r,...e)=>{var t=he(e);r=ge(r),r.map(i=>{t.map(s=>{i.classList.add(s)})})},T=(r,...e)=>{var t=he(e);r=ge(r),r.map(i=>{t.map(s=>{i.classList.remove(s)})})},he=r=>{var e=[];for(let t of r)typeof t=="string"&&(t=t.trim().split(/[\11\12\14\15\40]/)),Array.isArray(t)&&(e=e.concat(t));return e.filter(Boolean)},ge=r=>(Array.isArray(r)||(r=[r]),r),X=(r,e,t)=>{if(!(t&&!t.contains(r)))for(;r&&r.matches;){if(r.matches(e))return r;r=r.parentNode}},se=(r,e=0)=>e>0?r[r.length-1]:r[0],Ee=r=>Object.keys(r).length===0,N=(r,e)=>{if(!r)return-1;e=e||r.nodeName;for(var t=0;r=r.previousElementSibling;)r.matches(e)&&t++;return t},O=(r,e)=>{for(const t in e){let i=e[t];i==null?r.removeAttribute(t):r.setAttribute(t,""+i)}},Z=(r,e)=>{r.parentNode&&r.parentNode.replaceChild(e,r)},Le=(r,e)=>{if(e===null)return;if(typeof e=="string"){if(!e.length)return;e=new RegExp(e,"i")}const t=o=>{var n=o.data.match(e);if(n&&o.data.length>0){var l=document.createElement("span");l.className="highlight";var a=o.splitText(n.index);a.splitText(n[0].length);var c=a.cloneNode(!0);return l.appendChild(c),Z(a,l),1}return 0},i=o=>{if(o.nodeType===1&&o.childNodes&&!/(script|style)/i.test(o.tagName)&&(o.className!=="highlight"||o.tagName!=="SPAN"))for(var n=0;n<o.childNodes.length;++n)n+=s(o.childNodes[n])},s=o=>o.nodeType===3?t(o):(i(o),0);s(r)},Pe=r=>{var e=r.querySelectorAll("span.highlight");Array.prototype.forEach.call(e,function(t){var i=t.parentNode;i.replaceChild(t.firstChild,t),i.normalize()})},Te=65,ve=13,Ve=27,ee=37,$e=38,me=39,je=40,re=8,De=46,ne=9,Ke=typeof navigator=="undefined"?!1:/Mac/.test(navigator.userAgent),M=Ke?"metaKey":"ctrlKey";var oe={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,closeAfterSelect:!1,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-control",inputClass:"ts-input",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:null,copyClassesToDropdown:!0,placeholder:null,hidePlaceholder:null,shouldLoad:function(r){return r.length>0},render:{}};const P=r=>typeof r=="undefined"||r===null?null:te(r),te=r=>typeof r=="boolean"?r?"1":"0":r+"",H=r=>(r+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),Re=(r,e)=>{var t;return function(i,s){var o=this;t&&(o.loading=Math.max(o.loading-1,0),clearTimeout(t)),t=setTimeout(function(){t=null,o.loadedSearches[i]=!0,r.call(o,i,s)},e)}},le=(r,e,t)=>{var i,s=r.trigger,o={};r.trigger=function(){var n=arguments[0];if(e.indexOf(n)!==-1)o[n]=arguments;else return s.apply(r,arguments)},t.apply(r,[]),r.trigger=s;for(i in o)s.apply(r,o[i])},qe=r=>({start:r.selectionStart||0,length:(r.selectionEnd||0)-(r.selectionStart||0)}),y=(r,e=!1)=>{r&&(r.preventDefault(),e&&r.stopPropagation())},w=(r,e,t,i)=>{r.addEventListener(e,t,i)},j=(r,e)=>{if(!e||!e[r])return!1;var t=(e.altKey?1:0)+(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.metaKey?1:0);return t===1},W=(r,e)=>{const t=r.getAttribute("id");return t||(r.setAttribute("id",e),e)},ae=r=>r.replace(/[\\"']/g,"\\$&"),D=(r,e)=>{e&&r.append(e)};function _e(r,e){var t=Object.assign({},oe,e),i=t.dataAttr,s=t.labelField,o=t.valueField,n=t.disabledField,l=t.optgroupField,a=t.optgroupLabelField,c=t.optgroupValueField,u=r.tagName.toLowerCase(),h=r.getAttribute("placeholder")||r.getAttribute("data-placeholder");if(!h&&!t.allowEmptyOption){let d=r.querySelector('option[value=""]');d&&(h=d.textContent)}var m={placeholder:h,options:[],optgroups:[],items:[],maxItems:null},C=()=>{var d,v=m.options,b={},S=1,F=g=>{var _=Object.assign({},g.dataset),f=i&&_[i];return typeof f=="string"&&f.length&&(_=Object.assign(_,JSON.parse(f))),_},E=(g,_)=>{var f=P(g.value);if(f!=null&&!(!f&&!t.allowEmptyOption)){if(b.hasOwnProperty(f)){if(_){var p=b[f][l];p?Array.isArray(p)?p.push(_):b[f][l]=[p,_]:b[f][l]=_}}else{var x=F(g);x[s]=x[s]||g.textContent,x[o]=x[o]||f,x[n]=x[n]||g.disabled,x[l]=x[l]||_,x.$option=g,b[f]=x,v.push(x)}g.selected&&m.items.push(f)}},V=g=>{var _,f;f=F(g),f[a]=f[a]||g.getAttribute("label")||"",f[c]=f[c]||S++,f[n]=f[n]||g.disabled,m.optgroups.push(f),_=f[c];for(const p of g.children)E(p,_)};m.maxItems=r.hasAttribute("multiple")?null:1;for(const g of r.children)d=g.tagName.toLowerCase(),d==="optgroup"?V(g):d==="option"&&E(g)},I=()=>{const d=r.getAttribute(i);if(d){m.options=JSON.parse(d);for(const b of m.options)m.items.push(b[o])}else{var v=r.value.trim()||"";if(!t.allowEmptyOption&&!v.length)return;const b=v.split(t.delimiter);for(const S of b){const F={};F[s]=S,F[o]=S,m.options.push(F)}m.items=b}};return u==="select"?C():I(),Object.assign({},oe,m,e)}var ce=0;class L extends Oe(ye){constructor(e,l){super(),this.order=0,this.tab_key=!1,this.isOpen=!1,this.isDisabled=!1,this.isInvalid=!1,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.hasOptions=!1,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.renderCache={item:{},option:{}},ce++;var i,v=k(e),s=this;if(v.tomselect)throw new Error("Tom Select already initialized on this element");v.tomselect=this;var o=window.getComputedStyle&&window.getComputedStyle(v,null);i=o.getPropertyValue("direction"),this.settings=_e(v,l),this.input=v,this.tabIndex=v.tabIndex||0,this.is_select_tag=v.tagName.toLowerCase()==="select",this.rtl=/rtl/i.test(i),this.inputId=W(v,"tomselect-"+ce),this.isRequired=v.required,this.sifter=new ke(this.options,{diacritics:this.settings.diacritics}),this.setupOptions(this.settings.options,this.settings.optgroups),delete this.settings.optgroups,delete this.settings.options,this.settings.mode=this.settings.mode||(this.settings.maxItems===1?"single":"multi"),typeof this.settings.hideSelected!="boolean"&&(this.settings.hideSelected=this.settings.mode==="multi"),typeof this.settings.hidePlaceholder!="boolean"&&(this.settings.hidePlaceholder=this.settings.mode!=="multi");var n=this.settings.createFilter;typeof n!="function"&&(typeof n=="string"&&(n=new RegExp(n)),n instanceof RegExp?this.settings.createFilter=p=>n.test(p):this.settings.createFilter=()=>!0),this.initializePlugins(this.settings.plugins),this.setupCallbacks(),this.setupTemplates();var l=s.settings,a,c,u,h,m,C,I,d,v=s.input,b;const S={passive:!0},F=s.inputId+"-ts-dropdown";if(C=s.settings.mode,I=v.getAttribute("class")||"",a=k("<div>"),A(a,l.wrapperClass,I,C),c=k('<div class="items">'),A(c,l.inputClass),D(a,c),h=s._render("dropdown"),A(h,l.dropdownClass,C),m=k(`<div role="listbox" id="${F}" tabindex="-1">`),A(m,l.dropdownContentClass),D(h,m),k(l.dropdownParent||a).appendChild(h),l.controlInput)u=k(l.controlInput);else{u=k('<input type="text" autocomplete="off" size="1" />');var E=["autocorrect","autocapitalize","autocomplete"];for(const p of E)v.getAttribute(p)&&O(u,{[p]:v.getAttribute(p)})}l.controlInput||(u.tabIndex=v.disabled?-1:s.tabIndex,c.appendChild(u)),O(u,{role:"combobox",haspopup:"listbox","aria-expanded":"false","aria-controls":F}),b=W(u,s.inputId+"-tomselected");let V="label[for='"+Fe(s.inputId)+"']",g=document.querySelector(V);if(g){O(g,{for:b});let p=W(g,s.inputId+"-ts-label");O(m,{"aria-labelledby":p})}s.settings.copyClassesToDropdown&&A(h,I),a.style.width=v.style.width,s.plugins.names.length&&(d="plugin-"+s.plugins.names.join(" plugin-"),A([a,h],d)),(l.maxItems===null||l.maxItems>1)&&s.is_select_tag&&O(v,{multiple:"multiple"}),s.settings.placeholder&&O(u,{placeholder:l.placeholder}),!s.settings.splitOn&&s.settings.delimiter&&(s.settings.splitOn=new RegExp("\\s*"+J(s.settings.delimiter)+"+\\s*")),this.settings.load&&this.settings.loadThrottle&&(this.settings.load=Re(this.settings.load,this.settings.loadThrottle)),this.control=c,this.control_input=u,this.wrapper=a,this.dropdown=h,this.dropdown_content=m,s.control_input.type=v.type,w(h,"click",p=>{const x=X(p.target,"[data-selectable]");x&&(s.onOptionSelect(p,x),y(p,!0))}),w(c,"click",p=>{var x=X(p.target,"."+s.settings.itemClass,c);if(x&&s.onItemSelect(p,x)){y(p,!0);return}u.value==""&&(s.onClick(),y(p,!0))}),w(u,"mousedown",p=>{u.value!==""&&p.stopPropagation()}),w(u,"keydown",p=>s.onKeyDown(p)),w(u,"keyup",p=>s.onKeyUp(p)),w(u,"keypress",p=>s.onKeyPress(p)),w(u,"resize",()=>s.positionDropdown(),S),w(u,"blur",()=>s.onBlur()),w(u,"focus",p=>s.onFocus(p)),w(u,"paste",p=>s.onPaste(p));const _=p=>{const x=p.composedPath()[0];if(!a.contains(x)&&!h.contains(x)){s.isFocused&&s.blur(),s.inputState();return}y(p,!0)};var f=()=>{s.isOpen&&s.positionDropdown()};w(document,"mousedown",_),w(window,"sroll",f,S),w(window,"resize",f,S),this._destroy=()=>{document.removeEventListener("mousedown",_),window.removeEventListener("sroll",f),window.removeEventListener("resize",f)},this.revertSettings={innerHTML:v.innerHTML,tabIndex:v.tabIndex},v.tabIndex=-1,O(v,{hidden:"hidden"}),v.insertAdjacentElement("afterend",s.wrapper),s.setValue(l.items),l.items=[],w(v,"invalid",p=>{y(p),s.isInvalid||(s.isInvalid=!0,s.refreshState())}),s.updateOriginalInput(),s.refreshItems(),s.close(!1),s.inputState(),s.isSetup=!0,v.disabled&&s.disable(),s.on("change",this.onChange),A(v,"tomselected"),s.trigger("initialize"),l.preload===!0&&s.load(""),s.setup()}setup(){}setupOptions(e=[],t=[]){for(const i of e)this.registerOption(i);for(const i of t)this.registerOptionGroup(i)}setupTemplates(){var e=this,t=e.settings.labelField,i=e.settings.optgroupLabelField,s={optgroup:o=>{let n=document.createElement("div");return n.className="optgroup",n.appendChild(o.options),n},optgroup_header:(o,n)=>'<div class="optgroup-header">'+n(o[i])+"</div>",option:(o,n)=>"<div>"+n(o[t])+"</div>",item:(o,n)=>"<div>"+n(o[t])+"</div>",option_create:(o,n)=>'<div class="create">Add <strong>'+n(o.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};e.settings.render=Object.assign({},s,e.settings.render)}setupCallbacks(){var e,t,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in i)t=this.settings[i[e]],t&&this.on(e,t)}onClick(){var e=this;if(e.activeItems.length>0){e.clearActiveItems(),e.focus();return}e.isFocused&&e.isOpen?e.blur():e.focus()}onMouseDown(){}onChange(){G(this.input,"input"),G(this.input,"change")}onPaste(e){var t=this;if(t.isFull()||t.isInputHidden||t.isLocked){y(e);return}t.settings.splitOn&&setTimeout(()=>{var i=t.inputValue();if(!!i.match(t.settings.splitOn)){var s=i.trim().split(t.settings.splitOn);for(const o of s)t.createItem(o)}},0)}onKeyPress(e){var t=this;if(t.isLocked){y(e);return}var i=String.fromCharCode(e.keyCode||e.which);if(t.settings.create&&t.settings.mode==="multi"&&i===t.settings.delimiter){t.createItem(),y(e);return}}onKeyDown(e){var t=this;if(t.isLocked){e.keyCode!==ne&&y(e);return}switch(e.keyCode){case Te:if(j(M,e)){t.selectAll();return}break;case Ve:t.isOpen&&(y(e,!0),t.close()),t.clearActiveItems();return;case je:if(!t.isOpen&&t.hasOptions)t.open();else if(t.activeOption){let i=t.getAdjacent(t.activeOption,1);i&&t.setActiveOption(i)}y(e);return;case $e:if(t.activeOption){let i=t.getAdjacent(t.activeOption,-1);i&&t.setActiveOption(i)}y(e);return;case ve:t.isOpen&&t.activeOption?(t.onOptionSelect(e,t.activeOption),y(e)):t.settings.create&&t.createItem()&&y(e);return;case ee:t.advanceSelection(-1,e);return;case me:t.advanceSelection(1,e);return;case ne:t.settings.selectOnTab&&(t.isOpen&&t.activeOption&&(t.tab_key=!0,t.onOptionSelect(e,t.activeOption),y(e),t.tab_key=!1),t.settings.create&&t.createItem()&&y(e));return;case re:case De:t.deleteSelection(e);return}t.isInputHidden&&!j(M,e)&&y(e)}onKeyUp(e){var t=this;if(t.isLocked){y(e);return}var i=t.inputValue();t.lastValue!==i&&(t.lastValue=i,t.settings.shouldLoad.call(t,i)&&t.load(i),t.refreshOptions(),t.trigger("type",i))}onFocus(e){var t=this,i=t.isFocused;if(t.isDisabled){t.blur(),y(e);return}t.ignoreFocus||(t.isFocused=!0,t.settings.preload==="focus"&&t.load(""),i||t.trigger("focus"),t.activeItems.length||(t.showInput(),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())}onBlur(){var e=this;if(!!e.isFocused){e.isFocused=!1,e.ignoreFocus=!1;var t=()=>{e.close(),e.setActiveItem(),e.setCaret(e.items.length),e.trigger("blur")};e.settings.create&&e.settings.createOnBlur?e.createItem(null,!1,t):t()}}onOptionSelect(e,t){var i,s=this;!t||t.parentElement&&t.parentElement.matches("[data-disabled]")||(t.classList.contains("create")?s.createItem(null,!0,()=>{s.settings.closeAfterSelect&&s.close()}):(i=t.dataset.value,typeof i!="undefined"&&(s.lastQuery=null,s.addItem(i),s.settings.closeAfterSelect&&s.close(),!s.settings.hideSelected&&e.type&&/click/.test(e.type)&&s.setActiveOption(t))))}onItemSelect(e,t){var i=this;return!i.isLocked&&i.settings.mode==="multi"?(y(e),i.setActiveItem(t,e),!0):!1}canLoad(e){return!(!this.settings.load||this.loadedSearches.hasOwnProperty(e))}load(e){const t=this;if(!t.canLoad(e))return;A(t.wrapper,t.settings.loadingClass),t.loading++;const i=t.loadCallback.bind(t);t.settings.load.call(t,e,i)}loadCallback(e,t){const i=this;i.loading=Math.max(i.loading-1,0),i.lastQuery=null,i.clearActiveOption(),i.setupOptions(e,t),i.refreshOptions(i.isFocused&&!i.isInputHidden),i.loading||T(i.wrapper,i.settings.loadingClass),i.trigger("load",e,t)}setTextboxValue(e=""){var t=this.control_input,i=t.value!==e;i&&(t.value=e,G(t,"update"),this.lastValue=e)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){var i=t?[]:["change"];le(this,i,()=>{this.clear(t),this.addItems(e,t)})}setMaxItems(e){e===0&&(e=null),this.settings.maxItems=e,this.refreshState()}setActiveItem(e,t){var i=this,s,o,n,l,a,c;if(i.settings.mode!=="single"){if(!e){i.clearActiveItems(),i.isFocused&&i.showInput();return}if(s=t&&t.type.toLowerCase(),s==="click"&&j("shiftKey",t)&&i.activeItems.length){for(c=i.getLastActive(),n=Array.prototype.indexOf.call(i.control.children,c),l=Array.prototype.indexOf.call(i.control.children,e),n>l&&(a=n,n=l,l=a),o=n;o<=l;o++)e=i.control.children[o],i.activeItems.indexOf(e)===-1&&i.setActiveItemClass(e);y(t)}else s==="click"&&j(M,t)||s==="keydown"&&j("shiftKey",t)?e.classList.contains("active")?i.removeActiveItem(e):i.setActiveItemClass(e):(i.clearActiveItems(),i.setActiveItemClass(e));i.hideInput(),i.isFocused||i.focus()}}setActiveItemClass(e){const t=this,i=t.control.querySelector(".last-active");i&&T(i,"last-active"),A(e,"active last-active"),t.trigger("item_select",e),t.activeItems.indexOf(e)==-1&&t.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1),T(e,"active")}clearActiveItems(){T(this.activeItems,"active"),this.activeItems=[]}setActiveOption(e){e!==this.activeOption&&(this.clearActiveOption(),e&&(this.activeOption=e,O(this.control_input,{"aria-activedescendant":e.getAttribute("id")}),O(e,{"aria-selected":"true"}),A(e,"active"),this.scrollToOption(e)))}scrollToOption(e,t){if(!e)return;const i=this.dropdown_content,s=i.clientHeight,o=i.scrollTop||0,n=e.offsetHeight,l=e.getBoundingClientRect().top-i.getBoundingClientRect().top+o;l+n>s+o?this.scroll(l-s+n,t):l<o&&this.scroll(l,t)}scroll(e,t){const i=this.dropdown_content;t&&(i.style.scrollBehavior=t),i.scrollTop=e,i.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(T(this.activeOption,"active"),O(this.activeOption,{"aria-selected":null})),this.activeOption=null,O(this.control_input,{"aria-activedescendant":null})}selectAll(){this.settings.mode!=="single"&&(this.activeItems=this.controlChildren(),this.activeItems.length&&(A(this.activeItems,"active"),this.hideInput(),this.close()),this.focus())}inputState(){var e=this;e.settings.controlInput||(e.activeItems.length>0||!e.isFocused&&this.settings.hidePlaceholder&&e.items.length>0?(e.setTextboxValue(),e.isInputHidden=!0,A(e.wrapper,"input-hidden")):(e.isInputHidden=!1,T(e.wrapper,"input-hidden")))}hideInput(){this.inputState()}showInput(){this.inputState()}inputValue(){return this.control_input.value.trim()}focus(){var e=this;e.isDisabled||(e.ignoreFocus=!0,e.control_input.focus(),setTimeout(()=>{e.ignoreFocus=!1,e.onFocus()},0))}blur(){this.control_input.blur(),this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings,t=e.sortField;return typeof e.sortField=="string"&&(t=[{field:e.sortField}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,i,s,o=this,n=this.getSearchOptions();if(o.settings.score&&(s=o.settings.score.call(o,e),typeof s!="function"))throw new Error('Tom Select "score" setting must be a function that returns a function');if(e!==o.lastQuery?(o.lastQuery=e,i=o.sifter.search(e,Object.assign(n,{score:s})),o.currentResults=i):i=Object.assign({},o.currentResults),o.settings.hideSelected)for(t=i.items.length-1;t>=0;t--){let l=P(i.items[t].id);l&&o.items.indexOf(l)!==-1&&i.items.splice(t,1)}return i}refreshOptions(e=!0){var t,i,s,o,n,l,a,c,u,h,m;const C={},I=[];var d=this,v=d.inputValue(),b=d.search(v),S=d.activeOption,F=d.settings.shouldOpen||!1,E=d.dropdown_content;for(S&&(u=S.dataset.value,h=S.closest("[data-group]")),o=b.items.length,typeof d.settings.maxOptions=="number"&&(o=Math.min(o,d.settings.maxOptions)),o>0&&(F=!0),t=0;t<o;t++){let g=b.items[t].id,_=d.options[g],f=d.getOption(g,!0);for(d.settings.hideSelected||f.classList.toggle("selected",d.items.includes(g)),n=_[d.settings.optgroupField]||"",l=Array.isArray(n)?n:[n],i=0,s=l&&l.length;i<s;i++)n=l[i],d.optgroups.hasOwnProperty(n)||(n=""),C.hasOwnProperty(n)||(C[n]=document.createDocumentFragment(),I.push(n)),i>0&&(f=f.cloneNode(!0),O(f,{id:_.$id+"-clone-"+i,"aria-selected":null}),f.classList.add("ts-cloned"),T(f,"active")),u==g&&h&&h.dataset.group===n&&(S=f),C[n].appendChild(f)}this.settings.lockOptgroupOrder&&I.sort((g,_)=>{var f=d.optgroups[g]&&d.optgroups[g].$order||0,p=d.optgroups[_]&&d.optgroups[_].$order||0;return f-p}),a=document.createDocumentFragment();for(n of I)if(d.optgroups.hasOwnProperty(n)&&C[n].children.length){let g=document.createDocumentFragment(),_=d.render("optgroup_header",d.optgroups[n]);D(g,_),D(g,C[n]);let f=d.render("optgroup",{group:d.optgroups[n],options:g});D(a,f)}else D(a,C[n]);if(E.innerHTML="",D(E,a),d.settings.highlight&&(Pe(E),b.query.length&&b.tokens.length))for(const g of b.tokens)Le(E,g.regex);var V=g=>{let _=d.render(g,{input:v});return _&&(F=!0,E.insertBefore(_,E.firstChild)),_};if(d.settings.shouldLoad.call(d,v)?d.loading?V("loading"):b.items.length===0&&V("no_results"):V("not_loading"),c=d.canCreate(v),c&&(m=V("option_create")),d.hasOptions=b.items.length>0||c,F){if(b.items.length>0){if(!E.contains(S)&&d.settings.mode==="single"&&d.items.length&&(S=d.getOption(d.items[0])),!E.contains(S)){let g=0;m&&!d.settings.addPrecedence&&(g=1),S=d.selectable()[g]}}else m&&(S=m);e&&!d.isOpen&&(d.open(),d.scrollToOption(S,"auto")),d.setActiveOption(S)}else d.clearActiveOption(),e&&d.isOpen&&d.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e){var t,i=this;if(Array.isArray(e)){for(const s of e)i.addOption(s);return}(t=i.registerOption(e))&&(i.userOptions[t]=!0,i.lastQuery=null,i.trigger("option_add",t,e))}registerOption(e){var t=P(e[this.settings.valueField]);return t===null||this.options.hasOwnProperty(t)?!1:(e.$order=e.$order||++this.order,e.$id=this.inputId+"-opt-"+e.$order,this.options[t]=e,t)}registerOptionGroup(e){var t=P(e[this.settings.optgroupValueField]);return t===null?!1:(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)}addOptionGroup(e,t){var i;t[this.settings.optgroupValueField]=e,(i=this.registerOptionGroup(t))&&this.trigger("optgroup_add",i,t)}removeOptionGroup(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(e,t){const i=this;var s,o;const n=P(e);if(n===null)return;const l=P(t[i.settings.valueField]),a=i.getOption(n),c=i.getItem(n);if(!!i.options.hasOwnProperty(n)){if(typeof l!="string")throw new Error("Value must be set in option data");if(t.$order=t.$order||i.options[n].$order,delete i.options[n],i.uncacheValue(l),i.uncacheValue(n,!1),i.options[l]=t,a){if(i.dropdown_content.contains(a)){const u=i._render("option",t);Z(a,u),i.activeOption===a&&i.setActiveOption(u)}a.remove()}c&&(o=i.items.indexOf(n),o!==-1&&i.items.splice(o,1,l),s=i._render("item",t),c.classList.contains("active")&&A(s,"active"),Z(c,s)),i.lastQuery=null}}removeOption(e,t){const i=this;e=te(e),i.uncacheValue(e),delete i.userOptions[e],delete i.options[e],i.lastQuery=null,i.trigger("option_remove",e),i.removeItem(e,t)}clearOptions(){this.loadedSearches={},this.userOptions={},this.clearCache();var e={};for(let t in this.options)this.options.hasOwnProperty(t)&&this.items.indexOf(t)>=0&&(e[t]=this.options[t]);this.options=this.sifter.items=e,this.lastQuery=null,this.trigger("option_clear")}uncacheValue(e,t=!0){const i=this,s=i.renderCache.item,o=i.renderCache.option;if(s&&delete s[e],o&&delete o[e],t){const n=i.getOption(e);n&&n.remove()}}getOption(e,t=!1){var i=P(e),s=this.rendered("option",i);return!s&&t&&i!==null&&(s=this._render("option",this.options[i])),s}getAdjacent(e,t,i="option"){var s=this,o;if(!e)return null;i=="item"?o=s.controlChildren():o=s.dropdown_content.querySelectorAll("[data-selectable]");for(let n=0;n<o.length;n++)if(o[n]==e)return t>0?o[n+1]:o[n-1];return null}getItem(e){if(typeof e=="object")return e;var t=P(e);return t!==null?this.control.querySelector(`[data-value="${ae(t)}"]`):null}addItems(e,t){var i=this,s=Array.isArray(e)?e:[e];s=s.filter(o=>i.items.indexOf(o)===-1);for(let o=0,n=s.length;o<n;o++)i.isPending=o<n-1,i.addItem(s[o],t)}addItem(e,t){var i=t?[]:["change"];le(this,i,()=>{var s,o;const n=this,l=n.settings.mode,a=P(e);if(!(a&&n.items.indexOf(a)!==-1&&(l==="single"&&n.close(),l==="single"||!n.settings.duplicates))&&!(a===null||!n.options.hasOwnProperty(a))&&(l==="single"&&n.clear(t),!(l==="multi"&&n.isFull()))){if(s=n._render("item",n.options[a]),n.control.contains(s)&&(s=s.cloneNode(!0)),o=n.isFull(),n.items.splice(n.caretPos,0,a),n.insertAtCaret(s),n.isSetup){let c=n.selectable();if(!n.isPending&&n.settings.hideSelected){let u=n.getOption(a),h=n.getAdjacent(u,1);h&&n.setActiveOption(h)}n.isPending||n.refreshOptions(n.isFocused&&l!=="single"),!c.length||n.isFull()?n.close():n.isPending||n.positionDropdown(),n.trigger("item_add",a,s),n.isPending||n.updateOriginalInput({silent:t})}(!n.isPending||!o&&n.isFull())&&n.refreshState()}})}removeItem(e=null,t){const i=this;if(e=i.getItem(e),!e)return;var s,o;const n=e.dataset.value;s=N(e),e.remove(),e.classList.contains("active")&&(o=i.activeItems.indexOf(e),i.activeItems.splice(o,1),T(e,"active")),i.items.splice(s,1),i.lastQuery=null,!i.settings.persist&&i.userOptions.hasOwnProperty(n)&&i.removeOption(n,t),s<i.caretPos&&i.setCaret(i.caretPos-1),i.updateOriginalInput({silent:t}),i.refreshState(),i.positionDropdown(),i.trigger("item_remove",n,e)}createItem(e=null,t=!0,i=()=>{}){var s=this,o=s.caretPos,n;if(e=e||s.inputValue(),!s.canCreate(e))return i(),!1;s.lock();var l=!1,a=c=>{if(s.unlock(),!c||typeof c!="object")return i();var u=P(c[s.settings.valueField]);if(typeof u!="string")return i();s.setTextboxValue(),s.addOption(c),s.setCaret(o),s.addItem(u),s.refreshOptions(t&&s.settings.mode!=="single"),i(c),l=!0};return typeof s.settings.create=="function"?n=s.settings.create.call(this,e,a):n={[s.settings.labelField]:e,[s.settings.valueField]:e},l||a(n),!0}refreshItems(){var e=this;e.lastQuery=null,e.isSetup&&e.addItems(e.items),e.updateOriginalInput(),e.refreshState()}refreshState(){var e=this;e.refreshValidityState();var t=e.isFull(),i=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);var s=e.control.classList;s.toggle("focus",e.isFocused),s.toggle("disabled",e.isDisabled),s.toggle("required",e.isRequired),s.toggle("invalid",e.isInvalid),s.toggle("locked",i),s.toggle("full",t),s.toggle("not-full",!t),s.toggle("input-active",e.isFocused&&!e.isInputHidden),s.toggle("dropdown-active",e.isOpen),s.toggle("has-options",Ee(e.options)),s.toggle("has-items",e.items.length>0)}refreshValidityState(){var e=this;if(!!e.input.checkValidity){this.isRequired&&(e.input.required=!0);var t=!e.input.checkValidity();e.isInvalid=t,e.control_input.required=t,this.isRequired&&(e.input.required=!t)}}isFull(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const t=this;var i,s,o,n,l;if(t.is_select_tag){let c=function(u,h,m){return u||(u=k('<option value="'+H(h)+'">'+H(m)+"</option>")),t.input.prepend(u),a.push(u),O(u,{selected:"true"}),u.selected=!0,u};const a=[];if(t.input.querySelectorAll("option[selected]").forEach(u=>{O(u,{selected:null}),u.selected=!1}),t.items.length==0&&t.settings.mode=="single"&&!t.isRequired)n=t.input.querySelector('option[value=""]'),c(n,"","");else for(i=t.items.length-1;i>=0;i--)if(s=t.items[i],o=t.options[s],l=o[t.settings.labelField]||"",a.includes(o.$option)){const u=t.input.querySelector(`option[value="${ae(s)}"]:not([selected])`);c(u,s,l)}else o.$option=c(o.$option,s,l)}else t.input.value=t.getValue();t.isSetup&&(e.silent||t.trigger("change",t.getValue()))}open(){var e=this;e.isLocked||e.isOpen||e.settings.mode==="multi"&&e.isFull()||(e.isOpen=!0,O(e.control_input,{"aria-expanded":"true"}),e.refreshState(),z(e.dropdown,{visibility:"hidden",display:"block"}),e.positionDropdown(),z(e.dropdown,{visibility:"visible",display:"block"}),e.focus(),e.trigger("dropdown_open",e.dropdown))}close(e=!0){var t=this,i=t.isOpen;e&&(t.setTextboxValue(),t.settings.mode==="single"&&t.items.length&&(t.hideInput(),t.tab_key||t.blur())),t.isOpen=!1,O(t.control_input,{"aria-expanded":"false"}),z(t.dropdown,{display:"none"}),t.settings.hideSelected&&t.clearActiveOption(),t.refreshState(),i&&t.trigger("dropdown_close",t.dropdown)}positionDropdown(){if(this.settings.dropdownParent==="body"){var e=this.control,t=e.getBoundingClientRect(),i=e.offsetHeight+t.top+window.scrollY,s=t.left+window.scrollX;z(this.dropdown,{width:t.width+"px",top:i+"px",left:s+"px"})}}clear(e){var t=this;if(!!t.items.length){var i=t.controlChildren();for(const s of i)t.removeItem(s,!0);t.showInput(),e||t.updateOriginalInput(),t.trigger("clear")}}insertAtCaret(e){var t=this,i=Math.min(t.caretPos,t.items.length),s=t.control;i===0?s.insertBefore(e,s.firstChild):s.insertBefore(e,s.children[i]),t.setCaret(i+1)}deleteSelection(e){var t,i,s,o,n=this;t=e&&e.keyCode===re?-1:1,i=qe(n.control_input);const l=[];if(n.activeItems.length){o=se(n.activeItems,t),s=N(o),t>0&&s++;for(const c of n.activeItems)l.push(c)}else if((n.isFocused||n.settings.mode==="single")&&n.items.length){const c=n.controlChildren();t<0&&i.start===0&&i.length===0?l.push(c[n.caretPos-1]):t>0&&i.start===n.inputValue().length&&l.push(c[n.caretPos])}const a=l.map(c=>c.dataset.value);if(!a.length||typeof n.settings.onDelete=="function"&&n.settings.onDelete.call(n,a,e)===!1)return!1;for(y(e,!0),typeof s!="undefined"&&n.setCaret(s);l.length;)n.removeItem(l.pop());return n.showInput(),n.positionDropdown(),n.refreshOptions(!1),!0}advanceSelection(e,t){var i,s,o,n=this;n.rtl&&(e*=-1),!n.inputValue().length&&(j(M,t)||j("shiftKey",t)?(s=n.getLastActive(e),s?s.classList.contains("active")?o=n.getAdjacent(s,e,"item"):o=s:e>0?o=n.control_input.nextElementSibling:o=n.control_input.previousElementSibling,o&&(o.classList.contains("active")&&n.removeActiveItem(s),n.setActiveItemClass(o))):n.isFocused&&!n.activeItems.length?n.setCaret(n.caretPos+e):(s=n.getLastActive(e),s&&(i=N(s),n.setCaret(e>0?i+1:i),n.setActiveItem())))}getLastActive(e){let t=this.control.querySelector(".last-active");if(t)return t;var i=this.control.querySelectorAll(".active");if(i)return se(i,e)}setCaret(e){var t=this;t.settings.mode==="single"||t.settings.controlInput?e=t.items.length:(e=Math.max(0,Math.min(t.items.length,e)),e!=t.caretPos&&!t.isPending&&t.controlChildren().forEach((i,s)=>{s<e?t.control_input.insertAdjacentElement("beforebegin",i):t.control.appendChild(i)})),t.caretPos=e}controlChildren(){return Array.from(this.control.getElementsByClassName(this.settings.itemClass))}lock(){this.close(),this.isLocked=!0,this.refreshState()}unlock(){this.isLocked=!1,this.refreshState()}disable(){var e=this;e.input.disabled=!0,e.control_input.disabled=!0,e.control_input.tabIndex=-1,e.isDisabled=!0,e.lock()}enable(){var e=this;e.input.disabled=!1,e.control_input.disabled=!1,e.control_input.tabIndex=e.tabIndex,e.isDisabled=!1,e.unlock()}destroy(){var e=this,t=e.revertSettings;e.trigger("destroy"),e.off(),e.wrapper.remove(),e.dropdown.remove(),e.input.innerHTML=t.innerHTML,e.input.tabIndex=t.tabIndex,T(e.input,"tomselected"),O(e.input,{hidden:null}),e.input.required=this.isRequired,e._destroy(),delete e.input.tomselect}render(e,t){return typeof this.settings.render[e]!="function"?null:this._render(e,t)}_render(e,t){var i="",s,o;const n=this;return(e==="option"||e==="item")&&(i=te(t[n.settings.valueField]),o=n.rendered(e,i),o)||(o=n.settings.render[e].call(this,t,H),o==null)||(o=k(o),e==="option"||e==="option_create"?t[n.settings.disabledField]?O(o,{"aria-disabled":"true"}):O(o,{"data-selectable":""}):e==="optgroup"&&(s=t.group[n.settings.optgroupValueField],O(o,{"data-group":s}),t.group[n.settings.disabledField]&&O(o,{"data-disabled":""})),(e==="option"||e==="item")&&(O(o,{"data-value":i}),e==="item"?A(o,n.settings.itemClass):(A(o,n.settings.optionClass),O(o,{role:"option",id:t.$id})),n.renderCache[e][i]=o)),o}rendered(e,t){return t!==null&&this.renderCache[e].hasOwnProperty(t)?this.renderCache[e][t]:null}clearCache(e){var t=this;for(let i in t.options){const s=t.getOption(i);s&&s.remove()}e===void 0?t.renderCache={item:{},option:{}}:t.renderCache[e]={}}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,t,i){var s=this,o=s[t];s[t]=function(){var n,l;return e==="after"&&(n=o.apply(s,arguments)),l=i.apply(s,arguments),e==="instead"?l:(e==="before"&&(n=o.apply(s,arguments)),n)}}}L.define("change_listener",function(){const r=this,e=t=>t.join(r.settings.delimiter);w(r.input,"change",()=>{var t=_e(r.input,{delimiter:r.settings.delimiter});e(r.items)!=e(t.items)&&(r.setupOptions(t.options,t.optgroups),r.setValue(t.items))})});L.define("checkbox_options",function(){var r=this,e=r.onOptionSelect;r.settings.hideSelected=!1;var t=function(s){setTimeout(()=>{var o=s.querySelector("input");s.classList.contains("selected")?o.checked=!0:o.checked=!1},1)};r.hook("after","setupTemplates",()=>{var i=r.settings.render.option;r.settings.render.option=(s,o)=>{var n=k(i.call(r,s,o)),l=document.createElement("input");l.addEventListener("click",function(c){y(c)}),l.type="checkbox";const a=P(s[r.settings.valueField]);return a&&r.items.indexOf(a)>-1&&(l.checked=!0),n.prepend(l),n}}),r.on("item_remove",i=>{var s=r.getOption(i);s&&(s.classList.remove("selected"),t(s))}),r.hook("instead","onOptionSelect",(i,s)=>{if(s.classList.contains("selected")){s.classList.remove("selected"),r.removeItem(s.dataset.value),r.refreshOptions(),y(i,!0);return}e.call(r,i,s),t(s)})});L.define("clear_button",function(r){const e=this,t=Object.assign({className:"clear-button",title:"Clear All",html:i=>`<div class="${i.className}" title="${i.title}">&times;</div>`},r);e.on("initialize",()=>{var i=k(t.html(t));i.addEventListener("click",s=>{e.clear(),s.preventDefault(),s.stopPropagation()}),e.control.appendChild(i)})});L.define("drag_drop",function(){var r=this;if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if(r.settings.mode==="multi"){var e=r.lock,t=r.unlock;r.hook("instead","lock",()=>{var i=$(r.control).data("sortable");return i&&i.disable(),e.call(r)}),r.hook("instead","unlock",()=>{var i=$(r.control).data("sortable");return i&&i.enable(),t.call(r)}),r.on("initialize",()=>{var i=$(r.control).sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:r.isLocked,start:(s,o)=>{o.placeholder.css("width",o.helper.css("width")),i.css({overflow:"visible"})},stop:()=>{i.css({overflow:"hidden"});var s=[];i.children("[data-value]").each(function(){this.dataset.value&&s.push(this.dataset.value)}),r.setValue(s)}})})}});L.define("dropdown_header",function(r){const e=this,t=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:i=>'<div class="'+i.headerClass+'"><div class="'+i.titleRowClass+'"><span class="'+i.labelClass+'">'+i.title+'</span><a class="'+i.closeClass+'">&times;</a></div></div>'},r);e.on("initialize",()=>{var i=k(t.html(t)),s=i.querySelector("."+t.closeClass);s&&s.addEventListener("click",o=>{y(o,!0),e.close()}),e.dropdown.insertBefore(i,e.dropdown.firstChild)})});L.define("dropdown_input",function(){var r=this,e=r.settings.controlInput||'<input type="text" autocomplete="off" class="dropdown-input" />';e=k(e),r.settings.placeholder&&O(e,{placeholder:r.settings.placeholder}),r.settings.controlInput=e,r.settings.shouldOpen=!0,r.on("initialize",()=>{w(r.wrapper,"focus",s=>{r.onFocus(s)});const t=()=>{O(r.wrapper,{tabindex:r.input.disabled?"-1":r.tabIndex})};r.on("dropdown_close",t),r.on("dropdown_open",()=>O(r.wrapper,{tabindex:"-1"})),t(),w(r.wrapper,"keypress",s=>{if(!r.control.contains(s.target)&&!r.dropdown.contains(s.target))switch(s.keyCode){case ve:r.onClick();return}});let i=k('<div class="dropdown-input-wrap">');i.appendChild(e),r.dropdown.insertBefore(i,r.dropdown.firstChild)})});L.define("input_autogrow",function(){var r=this;r.on("initialize",()=>{var e=document.createElement("span"),t=r.control_input;e.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",r.wrapper.appendChild(e);var i=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"];for(const o of i)e.style[o]=t.style[o];var s=()=>{r.items.length>0?(e.textContent=t.value,t.style.width=e.clientWidth+"px"):t.style.width=""};s(),r.on("update item_add item_remove",s),w(t,"input",s),w(t,"keyup",s),w(t,"blur",s),w(t,"update",s)})});L.define("no_backspace_delete",function(){var r=this,e=r.deleteSelection;this.hook("instead","deleteSelection",t=>r.activeItems.length?e.call(r,t):!1)});L.define("no_active_items",function(){this.hook("instead","setActiveItem",()=>{}),this.hook("instead","selectAll",()=>{})});L.define("optgroup_columns",function(){var r=this,e=r.onKeyDown;r.hook("instead","onKeyDown",t=>{var i,s,o,n;if(!r.isOpen||!(t.keyCode===ee||t.keyCode===me))return e.call(r,t);n=X(r.activeOption,"[data-group]"),i=N(r.activeOption,"[data-selectable]"),n&&(t.keyCode===ee?n=n.previousSibling:n=n.nextSibling,n&&(o=n.querySelectorAll("[data-selectable]"),s=o[Math.min(o.length-1,i)],s&&r.setActiveOption(s)))})});L.define("remove_button",function(r){const e=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},r);var t=this;if(!!e.append){var i='<a href="javascript:void(0)" class="'+e.className+'" tabindex="-1" title="'+H(e.title)+'">'+e.label+"</a>";t.hook("after","setupTemplates",()=>{var s=t.settings.render.item;t.settings.render.item=(o,n)=>{var l=k(s.call(t,o,n)),a=k(i);return l.appendChild(a),w(a,"mousedown",c=>{y(c,!0)}),w(a,"click",c=>{if(y(c,!0),!t.isLocked){var u=l.dataset.value;t.removeItem(u),t.refreshOptions(!1)}}),l}})}});L.define("restore_on_backspace",function(r){const e=this,t=Object.assign({text:i=>i[e.settings.labelField]},r);e.on("item_remove",function(i){if(e.control_input.value.trim()===""){var s=e.options[i];s&&e.setTextboxValue(t.text.call(e,s))}})});L.define("virtual_scroll",function(){const r=this,e=r.canLoad,t=r.clearActiveOption,i=r.loadCallback;var s={},o,n=!1;if(!r.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";r.settings.sortField=[{field:"$order"},{field:"$score"}];function l(a){return typeof r.settings.maxOptions=="number"&&o.children.length>=r.settings.maxOptions?!1:!!(a in s&&s[a])}r.setNextUrl=function(a,c){s[a]=c},r.getUrl=function(a){if(a in s){const c=s[a];return s[a]=!1,c}return s={},r.settings.firstUrl(a)},r.hook("instead","clearActiveOption",()=>{if(!n)return t.call(r)}),r.hook("instead","canLoad",a=>a in s?l(a):e.call(r,a)),r.hook("instead","loadCallback",(a,c)=>{n||r.clearOptions(),i.call(r,a,c),n=!1}),r.hook("after","refreshOptions",()=>{const a=r.lastValue;var c;l(a)?(c=r.render("loading_more",{query:a}),c&&c.setAttribute("data-selectable","")):a in s&&!o.querySelector(".no-results")&&(c=r.render("no_more_results",{query:a})),c&&(A(c,r.settings.optionClass),o.append(c))}),r.on("initialize",()=>{o=r.dropdown_content,r.settings.render=Object.assign({},{loading_more:function(){return'<div class="loading-more-results">Loading more results ... </div>'},no_more_results:function(){return'<div class="no-more-results">No more results</div>'}},r.settings.render),o.addEventListener("scroll",function(){o.clientHeight/(o.scrollHeight-o.scrollTop)<.95||!l(r.lastValue)||n||(n=!0,r.load.call(r,r.lastValue))})})});export{L as T};
